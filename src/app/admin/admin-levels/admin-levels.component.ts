import { Component, OnInit } from '@angular/core';
import { AuthService } from '../../services/auth.service';

@Component({
  selector: 'app-admin-levels',
  templateUrl: './admin-levels.component.html',
  styleUrls: ['./admin-levels.component.scss']
})
export class AdminLevelsComponent implements OnInit {
  levels: any[] = [];
  newLevel = { nombre: '', descripcion: '' };

  constructor(private authService: AuthService) {}

  ngOnInit(): void {
    this.authService.getAllLevels().subscribe((response: any) => {
      if (response.success) {
        this.levels = response.levels;
      }
    });
  }

  onCreateLevel(): void {
    this.authService.createLevel(this.newLevel).subscribe((response: any) => {
      if (response.success) {
        this.levels.push({ id: response.nivelId, ...this.newLevel });
        this.newLevel = { nombre: '', descripcion: '' };
      }
    });
  }

  onDeleteLevel(id: number): void {
    this.authService.deleteLevel(id).subscribe((response: any) => {
      if (response.success) {
        this.levels = this.levels.filter(level => level.id !== id);
      }
    });
  }
}
