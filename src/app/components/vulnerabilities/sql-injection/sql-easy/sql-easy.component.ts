import { Component } from '@angular/core';
import { AuthService } from '../../../../services/auth.service'; // Asegúrate de que la ruta es correcta


@Component({
  selector: 'app-sql-easy',
  templateUrl: './sql-easy.component.html',
  styleUrls: ['./sql-easy.component.scss']
})
export class SqlEasyComponent {
    // Propiedades para la sección de inicio de sesión

  username: string = '';
  password: string = '';
  message: string = ''; // Mensaje de respuesta que se mostrará en la plantilla
  loginResult: string = ''; // Añade esta línea para definir loginResult


   // Propiedades para la sección de búsqueda
   searchTerm: string = '';
   searchResults: any[] = [];
   searchMessage: string = '';

  constructor(private authService: AuthService) {}

  onSubmit() {
// Asume que la respuesta es de tipo any y luego accede a la propiedad message.
this.authService.loginEasy(this.username, this.password).subscribe({
  next: (response: any) => {
    this.loginResult = response.message;
  },
  error: (error) => {
    this.loginResult = error.error.message || 'Error de inicio de sesión';
  }
});

  }
  

  // Ejemplo de uso del método de búsqueda
  onSearchSubmit() {
    this.authService.searchUsersEasy('texto de búsqueda').subscribe({
      next: (response: any) => {
        // Haz algo con los usuarios encontrados
        this.searchResults = response.users;
      },
      error: (error: any) => {
        // Manejar error
        this.searchMessage = error.error.message || 'Error al buscar usuarios';
      }
    });
  }


  searchUsersEasy(searchTerm: string) {
    this.authService.searchUsersEasy(searchTerm).subscribe({
      next: (data: any) => {
        // Si el servidor envía una respuesta con un formato esperado
        if (data.success) {
          this.searchResults = data.users;
          this.searchMessage = data.message;
        } else {
          this.searchMessage = 'No se encontraron resultados.';
        }
      },
      error: (error) => {
        // Manejar el error
        this.searchMessage = `Error: ${error.error.message}`;
      }
    });
  }
}