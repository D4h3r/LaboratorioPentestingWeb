const express = require('express');
const bodyParser = require('body-parser');
const app = express();
const port = 3000;
const cors = require('cors');



// Import routes
const inicioRoutes = require('../backend/inicio');
const usuariosRoutes = require('../models/usuarios');
const sqlEasyRoutes = require('../vulnerabilities/sql-easy'); 
const sqlMediumRoutes = require('../vulnerabilities/sql-medium'); 
const sqlHardRoutes = require('../vulnerabilities/sql-hard');
const commentsRoutes = require('../models/comments-routes'); 
const levelsRouter = require('../models/levels'); 
const xssMediumRoutes = require('../vulnerabilities/xss-medium');



app.use(cors());
app.use(express.json());

// Use routes
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
app.use('/api', inicioRoutes); 
app.use('/api', levelsRouter);
app.use('/api/sql-easy', sqlEasyRoutes);
app.use('/api/sql-version', sqlEasyRoutes);
app.use('/api/sql-medium', sqlMediumRoutes); 
app.use('/api/sql-hard', sqlHardRoutes);
app.use('/api', usuariosRoutes); 
app.use('/api/comments', commentsRoutes);
app.use('/api/xss-medium', xssMediumRoutes);
app.use('/api/xss-medium/validate-xss-medium', xssMediumRoutes);



app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});

const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./mydatabase.db', (err) => {
  if (err) {
    console.error('Could not connect to database', err);
  } else {
    console.log('Connected to the SQLite database.');
  }
});

module.exports = db;
